<!doctype html>
<html lang="en">
  <head>
    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{{ url_for('static', filename='favicon/apple-touch-icon.png') }}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{{ url_for('static', filename='favicon/favicon-32x32.png') }}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="{{ url_for('static', filename='favicon/favicon-16x16.png') }}"
    />
    <link
      rel="manifest"
      href="{{ url_for('static', filename='favicon/site.webmanifest') }}"
    />
    <link
      rel="mask-icon"
      href="{{ url_for('static', filename='favicon/safari-pinned-tab.svg') }}"
      color="#5bbad5"
    />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
    <link
      href="https://fonts.cdnfonts.com/css/neue-haas-grotesk-display-pro"
      rel="stylesheet"
    />
    <link
      href="https://fonts.cdnfonts.com/css/helvetica-neue-9"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script>
      const playlistData = JSON.parse('{{ playlists|tojson|safe }}');
    </script>
    <title>Recommendations</title>

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/recommendations.css') }}"
    />
  </head>
  <body>
    <div class="top-right-nav">
      <div class="nav-buttons">
        <a href="https://webstats.rawcsav.com/profile" class="profile-link"
          >Return to Profile</a
        >
        <a href="https://webstats.rawcsav.com/stats" class="stats-link"
          >View Stats</a
        >
      </div>
      <button id="showInstructions">Show Instructions</button>
    </div>
    <h1>Music Recommendations</h1>
    <a href="https://rawcsav.com" class="homepage-link">
      <img
        src="https://res.cloudinary.com/dn9bcrimg/image/upload/v1695251723/RawcSavLogo_iiq03n.png"
        alt="Homepage"
      />
    </a>
    <!-- After the title, redirect links, and image -->
    <div id="instructionsModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="instructions-container">
          <h3>How to Use:</h3>
          <h4>Search & Select:</h4>
          <p>
            Begin with at least one seed from a track, artist, or genre. Note:
            You can use a maximum combination of up to 5 seeds.
          </p>
          <ul>
            <li>
              Tracks: Input a track name and select from the dropdown results.
            </li>
            <li>
              Artists: Input an artist's name and choose from the results.
            </li>
            <li>Genres: Browse and select from the available genre options.</li>
          </ul>
          <h4>Tune Your Preferences:</h4>
          <ul>
            <li>
              Sliders: Adjust factors like popularity, energy, tempo, and more
              using the min-max sliders to match your mood or preference.
            </li>
            <li>
              Results Quantity: Choose the number of recommendations you'd like
              to receive.
            </li>
          </ul>
          <h4>Get Recommendations:</h4>
          <p>
            After setting your seeds and preferences, click the "Get
            Recommendations" button. A list of personalized music tracks will
            appear. Many tracks come with a built-in preview, allowing you to
            listen directly on the page. However, note that some tracks might
            not have a preview.
          </p>
          <p>Dive in and enjoy your music! ðŸŽµ</p>
        </div>
      </div>
    </div>
    <h2 class="search-title">Search Functions</h2>

    <hr class="custom-line" />
    <div class="search-container">
      <!-- Track search -->
      <div id="track_container">
        <datalist id="track_results"></datalist>
        <div class="input-container">
          <input
            type="text"
            id="track_input"
            list="track_results"
            placeholder="Track Search..."
            autocomplete="off"
          />
          <button type="button" id="track_search" class="search-btn">
            <img
              src="https://res.cloudinary.com/dn9bcrimg/image/upload/v1694755771/magnifying-glass-svgrepo-com_sf4h8b.svg"
              alt="Search"
              class="search-icon"
            />
          </button>
        </div>
        <div id="track_search_results">
          <div id="track_loading" class="loading-alert">Loading...</div>
          <div id="track_error" class="error-alert">
            An error occurred. Please try again.
          </div>
          <!-- Track search results will be displayed here -->
        </div>
      </div>
      <!-- Artist search -->
      <div id="artist_container">
        <datalist id="artist_results"></datalist>
        <div class="input-container">
          <input
            type="text"
            id="artist_input"
            list="artist_results"
            placeholder="Artist Search..."
            autocomplete="off"
          />
          <button type="button" id="artist_search" class="search-btn">
            <img
              src="https://res.cloudinary.com/dn9bcrimg/image/upload/v1694755771/magnifying-glass-svgrepo-com_sf4h8b.svg"
              alt="Search"
              class="search-icon"
            />
          </button>
        </div>
        <div id="artist_loading" class="loading-alert">Loading...</div>
        <div id="artist_error" class="error-alert">
          An error occurred. Please try again.
        </div>
        <div id="artist_search_results">
          <!-- Artist search results will be displayed here -->
        </div>
      </div>
      <div id="genre_container">
        <div class="input-container">
          <input
            type="text"
            id="genre_input"
            placeholder="Genre Search..."
            autocomplete="off"
          />
          <button type="button" id="genre_search" class="search-btn">
            <img
              src="https://res.cloudinary.com/dn9bcrimg/image/upload/v1694755771/magnifying-glass-svgrepo-com_sf4h8b.svg"
              alt="Search"
              class="search-icon"
            />
          </button>
        </div>
        <div id="genre_loading" class="loading-alert">Loading...</div>
        <div id="genre_error" class="error-alert">
          An error occurred. Please try again.
        </div>
        <div id="genre_search_results"></div>
      </div>
    </div>
    <div class="main-container">
      <div class="seed-container">
        <h2>Rec Seeds</h2>
        <!-- Track seeds -->
        <label for="track_seeds">Track Seeds:</label>
        <div id="track_seeds_container"></div>

        <!-- Artist seeds -->
        <label for="artist_seeds">Artist Seeds:</label>
        <div id="artist_seeds_container"></div>

        <label for="genre_seeds">Genre Seeds:</label>
        <div id="genre_seeds_container"></div>
        <!-- Genre seeds -->
      </div>
      <div class="results-container">
        <h2>Results</h2>
        <div id="results"></div>
      </div>
      <div class="form-container">
        <h2>Tuneable Features</h2>
        <form>
          <input type="hidden" id="track_seeds" name="track_seeds" />
          <input type="hidden" id="artist_seeds" name="artist_seeds" />
          <input type="hidden" id="genre_seeds" name="genre_seeds" />

          <label for="limit"># of Results:</label>
          <select name="limit" id="limit">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="75">75</option>
            <option value="100">100</option>
          </select>
          <!-- Popularity Slider -->
          <label>Popularity:</label>
          <div id="popularity_slider"></div>
          <input
            type="hidden"
            name="popularity_slider"
            id="popularity_input"
            value="0,100"
          />

          <!-- Energy Slider -->
          <label>Energy:</label>
          <div id="energy_slider"></div>
          <input
            type="hidden"
            name="energy_slider"
            id="energy_input"
            value="0,1"
          />

          <!-- Instrumentalness Slider -->
          <label>Instrumentalness:</label>
          <div id="instrumentalness_slider"></div>
          <input
            type="hidden"
            name="instrumentalness_slider"
            id="instrumentalness_input"
            value="0,1"
          />

          <!-- Tempo Slider -->
          <label>Tempo:</label>
          <div id="tempo_slider"></div>
          <input
            type="hidden"
            name="tempo_slider"
            id="tempo_input"
            value="24,208"
          />

          <!-- Danceability Slider -->
          <label>Danceability:</label>
          <div id="danceability_slider"></div>
          <input
            type="hidden"
            name="danceability_slider"
            id="danceability_input"
            value="0,1"
          />

          <!-- Valence Slider -->
          <label>Valence:</label>
          <div id="valence_slider"></div>
          <input
            type="hidden"
            name="valence_slider"
            id="valence_input"
            value="0,1"
          />
          <input type="submit" value="Get Recommendations" />
        </form>
      </div>
      <!-- Modal for displaying playlist options -->
      <div id="playlistModal" class="modal">
        <div class="playlist-modal-content">
          <span class="close">&times;</span>
          <div id="playlistOptions"></div>
        </div>
      </div>
    </div>
    <div
      id="toast"
      style="
        display: none;
        position: absolute;
        transform: translate(-50%, -50%);
      "
    ></div>
  </body>
  <script src="{{ url_for('static', filename='js/recommendations.js') }}"></script>
</html>
